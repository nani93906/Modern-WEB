<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google Tag Manager -->
  <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-T8C6RVQM');
  </script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Modern Web Store</title>

  <style>
    body { margin:0; font-family:Segoe UI; background:#f8fafc; }
    nav { background:#fff; padding:15px 30px; display:flex; justify-content:space-between; border-bottom:1px solid #ddd;}
    .logo { font-size:22px; font-weight:bold; color:#10b981; cursor:pointer;}
    .nav-links span { margin-left:20px; cursor:pointer;}
    .page { display:none; padding:40px;}
    .active { display:block;}
    .grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); gap:20px;}
    .card { background:#fff; padding:20px; border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,0.05);}
    .btn { background:#10b981; color:#fff; padding:10px; border:none; border-radius:6px; cursor:pointer; width:100%;}
    .btn-fail { background:#ef4444; }
  </style>
</head>

<body>

<nav>
  <div class="logo" onclick="route('home')">ModernWeb</div>
  <div class="nav-links">
    <span onclick="route('home')">Home</span>
    <span onclick="route('cart')">Cart (<span id="cartCount">0</span>)</span>
  </div>
</nav>

<!-- PLP -->
<div id="home" class="page active">
  <h2>Featured Products</h2>
  <div class="grid" id="productGrid"></div>
</div>

<!-- PDP -->
<div id="pdp" class="page">
  <div id="pdpContent" class="card"></div>
</div>

<!-- CART -->
<div id="cart" class="page">
  <h2>Your Cart</h2>
  <div id="cartItems"></div>
  <br>
  <button class="btn" onclick="route('checkout')">Proceed to Checkout</button>
</div>

<!-- CHECKOUT -->
<div id="checkout" class="page">
  <h2>Checkout</h2>
  <input type="text" placeholder="Full Name"><br><br>
  <input type="email" placeholder="Email"><br><br>
  <button class="btn" onclick="route('payment')">Proceed to Payment</button>
</div>

<!-- PAYMENT -->
<div id="payment" class="page">
  <h2>Payment</h2>
  <button class="btn" onclick="paymentSuccess()">Payment Success</button>
  <br><br>
  <button class="btn btn-fail" onclick="paymentFailed()">Payment Failed</button>
</div>

<!-- SUCCESS -->
<div id="success" class="page">
  <h2>Order Successful üéâ</h2>
  <p id="orderId"></p>
</div>

<!-- FAILED -->
<div id="failed" class="page">
  <h2 style="color:red;">Payment Failed ‚ùå</h2>
</div>

<script>
window.dataLayer = window.dataLayer || [];

const products = [
 {id:"P1", name:"Nike Shoes", price:2700},
 {id:"P2", name:"Adidas Runner", price:4200},
 {id:"P3", name:"H&M Blazer", price:3500},
 {id:"P4", name:"Mango Top", price:1800}
];

let cart = [];
let currentProduct = null;

/* ROUTING */
function route(page){
 document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
 document.getElementById(page).classList.add('active');

 window.dataLayer.push({
   event:"page_view",
   page_name:page
 });
}

/* RENDER PLP */
function renderProducts(){
 document.getElementById('productGrid').innerHTML =
 products.map(p=>`
   <div class="card" onclick="viewPDP('${p.id}')">
     <h4>${p.name}</h4>
     <p>‚Çπ${p.price}</p>
   </div>
 `).join('');
}

/* PDP */
function viewPDP(id){
 currentProduct = products.find(p=>p.id===id);
 route('pdp');

 document.getElementById('pdpContent').innerHTML = `
   <h2>${currentProduct.name}</h2>
   <p>Price: ‚Çπ${currentProduct.price}</p>
   <button class="btn" onclick="addToCart()">Add to Cart</button>
 `;

 window.dataLayer.push({
   event:"view_item",
   product_name:currentProduct.name,
   product_price:currentProduct.price
 });
}

/* ADD TO CART */
function addToCart(){
 cart.push(currentProduct);
 updateCartUI();

 window.dataLayer.push({
   event:"add_to_cart",
   product_name:currentProduct.name,
   product_price:currentProduct.price
 });

 route('cart');
}

/* CART UI */
function updateCartUI(){
 document.getElementById('cartCount').innerText = cart.length;

 document.getElementById('cartItems').innerHTML =
 cart.map(p=>`
   <div class="card">
     ${p.name} - ‚Çπ${p.price}
   </div>
 `).join('');
}

/* PAYMENT SUCCESS */
function paymentSuccess(){
 const orderId = "ORD-"+Math.floor(Math.random()*100000);
 document.getElementById('orderId').innerText="Order ID: "+orderId;
 route('success');

 window.dataLayer.push({
   event:"purchase",
   order_id:orderId,
   value:cart.reduce((sum,p)=>sum+p.price,0)
 });

 cart=[];
 updateCartUI();
}

/* PAYMENT FAILED */
function paymentFailed(){
 route('failed');

 window.dataLayer.push({
   event:"payment_failed"
 });
}

renderProducts();
</script>

</body>
</html>
